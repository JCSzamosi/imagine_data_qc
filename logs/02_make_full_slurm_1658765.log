module load r/4.5.0
Rscript ./scripts/asvs/02_make_full.R
-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
v dplyr     1.1.4     v readr     2.1.5
v forcats   1.0.0     v stringr   1.5.1
v ggplot2   3.5.2     v tibble    3.3.0
v lubridate 1.9.4     v tidyr     1.3.1
v purrr     1.1.0     
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()
i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

Reading in tax table

Reading in asv table

Checking the rownames match

Reading in the mapfile

Checking for duplicates

Duplicates found. Removing them

Checking for missing samples.
Some samples in the ASV table are absent from the mapfile. Continuing
Some samples in the mapfile are absent from the ASV table. Continuing

Cleaning up the mapfile

Creating the phyloseq object

The original ASV table had 12839 samples and 101609 ASVs

The original map table had 13589 rows after removing duplicates.

The phyloseq object has 12838 samples and 101609 taxa before removing host

Propagating taxon IDs down the levels
Joining with `by = join_by(Kingdom, Phylum, Class, Order, Family, Genus)`

Removing host ASVs

The phyloseq object has 99715 taxa after removing host.

Writing phyloseq object files

Writing the individual tables

Writing track stats

DONE
